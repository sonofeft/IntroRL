<html><head><title>figure_7_2.py</title></head><body>
<style type="text/css">.default .hll { background-color: #ffffcc }
.default  { background: #f8f8f8; font-family: Courier New, monospace; font-size: 16px; }
.linenos { width: 40px;  font-family: Courier New, monospace; font-size: 16px; }
.default .c { color: #408080; font-style: italic } /* Comment */
.default .err { border: 1px solid #FF0000 } /* Error */
.default .k { color: #008000; font-weight: bold } /* Keyword */
.default .o { color: #666666 } /* Operator */
.default .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.default .cp { color: #BC7A00 } /* Comment.Preproc */
.default .c1 { color: #408080; font-style: italic } /* Comment.Single */
.default .cs { color: #408080; font-style: italic } /* Comment.Special */
.default .gd { color: #A00000 } /* Generic.Deleted */
.default .ge { font-style: italic } /* Generic.Emph */
.default .gr { color: #FF0000 } /* Generic.Error */
.default .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.default .gi { color: #00A000 } /* Generic.Inserted */
.default .go { color: #808080 } /* Generic.Output */
.default .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.default .gs { font-weight: bold } /* Generic.Strong */
.default .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.default .gt { color: #0040D0 } /* Generic.Traceback */
.default .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.default .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.default .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.default .kp { color: #008000 } /* Keyword.Pseudo */
.default .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.default .kt { color: #B00040 } /* Keyword.Type */
.default .m { color: #666666 } /* Literal.Number */
.default .s { color: #BA2121 } /* Literal.String */
.default .na { color: #7D9029 } /* Name.Attribute */
.default .nb { color: #008000 } /* Name.Builtin */
.default .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.default .no { color: #880000 } /* Name.Constant */
.default .nd { color: #AA22FF } /* Name.Decorator */
.default .ni { color: #999999; font-weight: bold } /* Name.Entity */
.default .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.default .nf { color: #0000FF } /* Name.Function */
.default .nl { color: #A0A000 } /* Name.Label */
.default .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.default .nt { color: #008000; font-weight: bold } /* Name.Tag */
.default .nv { color: #19177C } /* Name.Variable */
.default .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.default .w { color: #bbbbbb } /* Text.Whitespace */
.default .mf { color: #666666 } /* Literal.Number.Float */
.default .mh { color: #666666 } /* Literal.Number.Hex */
.default .mi { color: #666666 } /* Literal.Number.Integer */
.default .mo { color: #666666 } /* Literal.Number.Oct */
.default .sb { color: #BA2121 } /* Literal.String.Backtick */
.default .sc { color: #BA2121 } /* Literal.String.Char */
.default .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.default .s2 { color: #BA2121 } /* Literal.String.Double */
.default .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.default .sh { color: #BA2121 } /* Literal.String.Heredoc */
.default .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.default .sx { color: #008000 } /* Literal.String.Other */
.default .sr { color: #BB6688 } /* Literal.String.Regex */
.default .s1 { color: #BA2121 } /* Literal.String.Single */
.default .ss { color: #19177C } /* Literal.String.Symbol */
.default .bp { color: #008000 } /* Name.Builtin.Pseudo */
.default .vc { color: #19177C } /* Name.Variable.Class */
.default .vg { color: #19177C } /* Name.Variable.Global */
.default .vi { color: #19177C } /* Name.Variable.Instance */
.default .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<h2>figure_7_2.py</h2>
<table class="defaulttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134</pre></div></td><td class="code"><div class="default"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">introrl.td_funcs.td0_prediction</span> <span class="kn">import</span> <span class="n">td0_prediction</span>
<span class="kn">from</span> <span class="nn">introrl.utils.running_ave</span> <span class="kn">import</span> <span class="n">RunningAve</span>
<span class="kn">from</span> <span class="nn">introrl.mc_funcs.mc_ev_prediction</span> <span class="kn">import</span> <span class="n">mc_every_visit_prediction</span>
<span class="kn">from</span> <span class="nn">introrl.policy</span> <span class="kn">import</span> <span class="n">Policy</span>
<span class="kn">from</span> <span class="nn">introrl.agent_supt.state_value_coll</span> <span class="kn">import</span> <span class="n">StateValueColl</span>
<span class="kn">from</span> <span class="nn">introrl.agent_supt.nstep_td_eval_walker</span> <span class="kn">import</span> <span class="n">NStepTDWalker</span>
<span class="kn">from</span> <span class="nn">introrl.mdp_data.random_walk_generic_mrp</span> <span class="kn">import</span> <span class="n">get_random_walk</span>
<span class="kn">from</span> <span class="nn">introrl.agent_supt.episode_maker</span> <span class="kn">import</span> <span class="n">make_episode</span>

<span class="n">GAMMA</span><span class="o">=</span><span class="mf">1.0</span>

<span class="n">AVE_OVER</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">rw_mrp</span> <span class="o">=</span> <span class="n">get_random_walk</span><span class="p">(</span><span class="n">Nside_states</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">win_reward</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">lose_reward</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">step_reward</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span> <span class="n">environment</span><span class="o">=</span><span class="n">rw_mrp</span> <span class="p">)</span>

<span class="n">policy</span><span class="o">.</span><span class="n">intialize_policy_to_equiprobable</span><span class="p">()</span> <span class="c1"># should be equiprobable from above init already</span>

<span class="n">episode_obj</span> <span class="o">=</span> <span class="n">make_episode</span><span class="p">(</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">policy</span><span class="p">,</span> <span class="n">rw_mrp</span> <span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># ---------------- set up true value data for RMS calc --------------------</span>
<span class="n">true_valueD</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">}</span> <span class="c1"># { &#39;Win&#39;:0.0, &#39;Lose&#39;:0.0}</span>

<span class="c1">#print(&#39;rw_mrp.get_num_states() = &#39;,rw_mrp.get_num_states())</span>
<span class="n">delta</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">rw_mrp</span><span class="o">.</span><span class="n">get_num_states</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Nsides</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">rw_mrp</span><span class="o">.</span><span class="n">get_num_states</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">d</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Nsides</span><span class="o">+</span><span class="mi">1</span> <span class="p">):</span>
    <span class="n">d</span> <span class="o">+=</span> <span class="n">delta</span>
    <span class="n">true_valueD</span><span class="p">[</span> <span class="s1">&#39;L-</span><span class="si">%i</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="o">%-</span><span class="n">d</span><span class="p">)</span> <span class="c1"># I got mad about the small bits.</span>
    <span class="n">true_valueD</span><span class="p">[</span> <span class="s1">&#39;R+</span><span class="si">%i</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%g</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">d</span><span class="p">)</span>

<span class="c1">#print(&#39;true_valueD =&#39;,true_valueD)</span>
<span class="c1">#sys.exit()</span>

<span class="c1"># ----------------------------------------- generate data -------------</span>
<span class="n">alphaL</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.05</span><span class="o">*</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">21</span><span class="p">)]</span>
<span class="n">nstepL</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">]</span>

<span class="n">nstep_walkerL</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">ave_rms_aveD</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># index=(alpha, Nsteps), value=RunningAve</span>
<span class="n">sv_collD</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># index=(alpha, Nsteps), value=StateValueColl</span>

<span class="c1"># create data structures</span>
<span class="k">for</span> <span class="n">Nsteps</span> <span class="ow">in</span> <span class="n">nstepL</span><span class="p">:</span>
    <span class="n">nstep_walkerL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">NStepTDWalker</span><span class="p">(</span><span class="n">rw_mrp</span><span class="p">,</span> <span class="n">Nsteps</span><span class="o">=</span><span class="n">Nsteps</span><span class="p">,</span>  <span class="n">episode_obj</span><span class="o">=</span><span class="n">episode_obj</span><span class="p">)</span> <span class="p">)</span>
    <span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">alphaL</span><span class="p">:</span>
        <span class="n">ave_rms_aveD</span><span class="p">[</span> <span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">Nsteps</span><span class="p">)</span> <span class="p">]</span> <span class="o">=</span> <span class="n">RunningAve</span><span class="p">()</span>
        <span class="n">sv_collD</span><span class="p">[</span> <span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">Nsteps</span><span class="p">)</span> <span class="p">]</span> <span class="o">=</span> <span class="n">StateValueColl</span><span class="p">(</span> <span class="n">rw_mrp</span><span class="p">,</span> <span class="n">init_val</span><span class="o">=</span><span class="mf">0.0</span> <span class="p">)</span>

<span class="c1"># begin main loop over runs</span>
<span class="k">for</span> <span class="n">loop</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">AVE_OVER</span><span class="p">):</span> <span class="c1"># average rms curves over AVE_OVER runs</span>
    <span class="k">if</span> <span class="n">loop</span><span class="o">%</span><span class="mi">10</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    
    <span class="c1"># set state variables to 0.0</span>
    <span class="k">for</span> <span class="n">Nsteps</span> <span class="ow">in</span>  <span class="n">nstepL</span> <span class="p">:</span>
        <span class="k">for</span>  <span class="n">alpha</span> <span class="ow">in</span> <span class="n">alphaL</span><span class="p">:</span>
            <span class="n">sv_collD</span><span class="p">[</span> <span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">Nsteps</span><span class="p">)</span> <span class="p">]</span><span class="o">.</span><span class="n">init_Vs_to_val</span><span class="p">(</span> <span class="mf">0.0</span> <span class="p">)</span>

            <span class="c1"># get the initial RMS </span>
            <span class="c1">#rms = sv_collD[ (alpha, Nsteps) ].calc_rms_error( true_valueD )</span>
            <span class="c1">#ave_rms_aveD[ (alpha, Nsteps) ].add_val( rms )</span>


    <span class="c1"># look at first 10 episodes</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">episode_obj</span> <span class="o">=</span> <span class="n">make_episode</span><span class="p">(</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">policy</span><span class="p">,</span> <span class="n">rw_mrp</span> <span class="p">)</span>
        
        <span class="c1"># have each alpha and Nsteps use the same episode_obj</span>
        <span class="k">for</span> <span class="n">istep</span><span class="p">,</span><span class="n">Nsteps</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="n">nstepL</span> <span class="p">):</span>
            <span class="n">nstep_walkerL</span><span class="p">[</span> <span class="n">istep</span> <span class="p">]</span><span class="o">.</span><span class="n">set_episode_obj</span><span class="p">(</span> <span class="n">episode_obj</span> <span class="p">)</span>
            
            <span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">alphaL</span><span class="p">:</span>
                <span class="n">nstep_walkerL</span><span class="p">[</span> <span class="n">istep</span> <span class="p">]</span><span class="o">.</span><span class="n">do_td_state_value_updates</span><span class="p">(</span> <span class="n">sv_collD</span><span class="p">[</span> <span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">Nsteps</span><span class="p">)</span> <span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="n">GAMMA</span><span class="p">)</span>

                <span class="c1"># get the RMS after each episode.</span>
                <span class="n">rms</span> <span class="o">=</span> <span class="n">sv_collD</span><span class="p">[</span> <span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">Nsteps</span><span class="p">)</span> <span class="p">]</span><span class="o">.</span><span class="n">calc_rms_error</span><span class="p">(</span> <span class="n">true_valueD</span> <span class="p">)</span>
                <span class="n">ave_rms_aveD</span><span class="p">[</span> <span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">Nsteps</span><span class="p">)</span> <span class="p">]</span><span class="o">.</span><span class="n">add_val</span><span class="p">(</span> <span class="n">rms</span> <span class="p">)</span>
        
<span class="k">print</span><span class="p">()</span>

<span class="n">colorD</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">:</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">:</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="mi">64</span><span class="p">:</span><span class="s1">&#39;y&#39;</span><span class="p">}</span>

<span class="k">for</span> <span class="n">Nsteps</span> <span class="ow">in</span>  <span class="n">nstepL</span> <span class="p">:</span>
    <span class="n">ave_rmsL</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span>  <span class="n">alpha</span> <span class="ow">in</span> <span class="n">alphaL</span><span class="p">:</span>
        <span class="n">ave_rmsL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">ave_rms_aveD</span><span class="p">[</span> <span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">Nsteps</span><span class="p">)</span> <span class="p">]</span><span class="o">.</span><span class="n">get_ave</span><span class="p">()</span> <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alphaL</span><span class="p">,</span> <span class="n">ave_rmsL</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-&#39;</span><span class="o">%</span><span class="n">colorD</span><span class="p">[</span><span class="n">Nsteps</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Nsteps=</span><span class="si">%i</span><span class="s1">, IntroRL&#39;</span><span class="o">%</span><span class="n">Nsteps</span> <span class="p">)</span>

    
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Ave. RMS Error (100 experiments)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Alpha &#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;($\alpha$)&#39;</span><span class="p">)</span>

<span class="c1"># Digitized Sutton &amp; Barto Figure 7.2</span>
<span class="n">alpha_1L</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.000466921</span><span class="p">,</span><span class="mf">0.0557666</span><span class="p">,</span><span class="mf">0.107186</span><span class="p">,</span><span class="mf">0.167336</span><span class="p">,</span><span class="mf">0.259502</span><span class="p">,</span><span class="mf">0.364281</span><span class="p">,</span><span class="mf">0.489432</span><span class="p">,</span><span class="mf">0.608763</span><span class="p">,</span><span class="mf">0.697049</span><span class="p">,</span><span class="mf">0.740706</span><span class="p">,</span><span class="mf">0.82026</span><span class="p">,</span><span class="mf">0.906605</span><span class="p">,</span><span class="mf">0.998771</span><span class="p">]</span>
<span class="n">rms_1L</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.547304</span><span class="p">,</span><span class="mf">0.523969</span><span class="p">,</span><span class="mf">0.504338</span><span class="p">,</span><span class="mf">0.482114</span><span class="p">,</span><span class="mf">0.452483</span><span class="p">,</span><span class="mf">0.42211</span><span class="p">,</span><span class="mf">0.390997</span><span class="p">,</span><span class="mf">0.366922</span><span class="p">,</span><span class="mf">0.354698</span><span class="p">,</span><span class="mf">0.350254</span><span class="p">,</span><span class="mf">0.347291</span><span class="p">,</span><span class="mf">0.353587</span><span class="p">,</span><span class="mf">0.390256</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alpha_1L</span><span class="p">,</span> <span class="n">rms_1L</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">:&#39;</span><span class="o">%</span><span class="n">colorD</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Nsteps=1, Sutton&#39;</span> <span class="p">)</span>

<span class="n">alpha_2L</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.0630475</span><span class="p">,</span><span class="mf">0.112517</span><span class="p">,</span><span class="mf">0.183867</span><span class="p">,</span><span class="mf">0.278049</span><span class="p">,</span><span class="mf">0.385549</span><span class="p">,</span><span class="mf">0.474023</span><span class="p">,</span><span class="mf">0.547276</span><span class="p">,</span><span class="mf">0.60721</span><span class="p">,</span><span class="mf">0.675706</span><span class="p">,</span><span class="mf">0.752764</span><span class="p">,</span><span class="mf">0.826017</span><span class="p">,</span><span class="mf">0.903075</span><span class="p">,</span><span class="mf">0.996305</span><span class="p">]</span>
<span class="n">rms_2L</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.546836</span><span class="p">,</span><span class="mf">0.497455</span><span class="p">,</span><span class="mf">0.460782</span><span class="p">,</span><span class="mf">0.415758</span><span class="p">,</span><span class="mf">0.364198</span><span class="p">,</span><span class="mf">0.317721</span><span class="p">,</span><span class="mf">0.291578</span><span class="p">,</span><span class="mf">0.281411</span><span class="p">,</span><span class="mf">0.281411</span><span class="p">,</span><span class="mf">0.288673</span><span class="p">,</span><span class="mf">0.307554</span><span class="p">,</span><span class="mf">0.331156</span><span class="p">,</span><span class="mf">0.367466</span><span class="p">,</span><span class="mf">0.437544</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alpha_2L</span><span class="p">,</span> <span class="n">rms_2L</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">:&#39;</span><span class="o">%</span><span class="n">colorD</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Nsteps=2, Sutton&#39;</span> <span class="p">)</span>

<span class="n">alpha_4L</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.000259455</span><span class="p">,</span><span class="mf">0.0440208</span><span class="p">,</span><span class="mf">0.0820741</span><span class="p">,</span><span class="mf">0.130592</span><span class="p">,</span><span class="mf">0.19338</span><span class="p">,</span><span class="mf">0.267584</span><span class="p">,</span><span class="mf">0.330372</span><span class="p">,</span><span class="mf">0.370328</span><span class="p">,</span><span class="mf">0.429311</span><span class="p">,</span><span class="mf">0.519687</span><span class="p">,</span><span class="mf">0.638604</span><span class="p">,</span><span class="mf">0.774645</span><span class="p">,</span><span class="mf">0.904026</span><span class="p">,</span><span class="mf">0.999159</span><span class="p">]</span>
<span class="n">rms_4L</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.54611</span><span class="p">,</span><span class="mf">0.480753</span><span class="p">,</span><span class="mf">0.43355</span><span class="p">,</span><span class="mf">0.381264</span><span class="p">,</span><span class="mf">0.328251</span><span class="p">,</span><span class="mf">0.286858</span><span class="p">,</span><span class="mf">0.270155</span><span class="p">,</span><span class="mf">0.267614</span><span class="p">,</span><span class="mf">0.272334</span><span class="p">,</span><span class="mf">0.290852</span><span class="p">,</span><span class="mf">0.328251</span><span class="p">,</span><span class="mf">0.383442</span><span class="p">,</span><span class="mf">0.449526</span><span class="p">,</span><span class="mf">0.515247</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alpha_4L</span><span class="p">,</span> <span class="n">rms_4L</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">:&#39;</span><span class="o">%</span><span class="n">colorD</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Nsteps=4, Sutton&#39;</span> <span class="p">)</span>

<span class="n">alpha_8L</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.000691879</span><span class="p">,</span><span class="mf">0.0192861</span><span class="p">,</span><span class="mf">0.0421181</span><span class="p">,</span><span class="mf">0.0725608</span><span class="p">,</span><span class="mf">0.108711</span><span class="p">,</span><span class="mf">0.15057</span><span class="p">,</span><span class="mf">0.190526</span><span class="p">,</span><span class="mf">0.220969</span><span class="p">,</span><span class="mf">0.274243</span><span class="p">,</span><span class="mf">0.373182</span><span class="p">,</span><span class="mf">0.525395</span><span class="p">,</span><span class="mf">0.672852</span><span class="p">,</span><span class="mf">0.814601</span><span class="p">,</span><span class="mf">0.931615</span><span class="p">]</span>
<span class="n">rms_8L</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.547926</span><span class="p">,</span><span class="mf">0.495276</span><span class="p">,</span><span class="mf">0.442627</span><span class="p">,</span><span class="mf">0.385984</span><span class="p">,</span><span class="mf">0.336239</span><span class="p">,</span><span class="mf">0.300656</span><span class="p">,</span><span class="mf">0.284316</span><span class="p">,</span><span class="mf">0.280685</span><span class="p">,</span><span class="mf">0.285769</span><span class="p">,</span><span class="mf">0.31409</span><span class="p">,</span><span class="mf">0.372912</span><span class="p">,</span><span class="mf">0.433187</span><span class="p">,</span><span class="mf">0.492735</span><span class="p">,</span><span class="mf">0.549741</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alpha_8L</span><span class="p">,</span> <span class="n">rms_8L</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">:&#39;</span><span class="o">%</span><span class="n">colorD</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Nsteps=8, Sutton&#39;</span> <span class="p">)</span>

<span class="n">alpha_16L</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.000503249</span><span class="p">,</span><span class="mf">0.0198703</span><span class="p">,</span><span class="mf">0.0431544</span><span class="p">,</span><span class="mf">0.0615876</span><span class="p">,</span><span class="mf">0.0839015</span><span class="p">,</span><span class="mf">0.109126</span><span class="p">,</span><span class="mf">0.135321</span><span class="p">,</span><span class="mf">0.181889</span><span class="p">,</span><span class="mf">0.240099</span><span class="p">,</span><span class="mf">0.308981</span><span class="p">,</span><span class="mf">0.386594</span><span class="p">,</span><span class="mf">0.459357</span><span class="p">,</span><span class="mf">0.560255</span><span class="p">,</span><span class="mf">0.721303</span><span class="p">]</span>
<span class="n">rms_16L</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.546934</span><span class="p">,</span><span class="mf">0.460631</span><span class="p">,</span><span class="mf">0.396183</span><span class="p">,</span><span class="mf">0.360254</span><span class="p">,</span><span class="mf">0.333586</span><span class="p">,</span><span class="mf">0.317659</span><span class="p">,</span><span class="mf">0.312844</span><span class="p">,</span><span class="mf">0.322104</span><span class="p">,</span><span class="mf">0.345439</span><span class="p">,</span><span class="mf">0.379515</span><span class="p">,</span><span class="mf">0.416554</span><span class="p">,</span><span class="mf">0.449149</span><span class="p">,</span><span class="mf">0.489893</span><span class="p">,</span><span class="mf">0.549526</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alpha_16L</span><span class="p">,</span> <span class="n">rms_16L</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">:&#39;</span><span class="o">%</span><span class="n">colorD</span><span class="p">[</span><span class="mi">16</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Nsteps=16, Sutton&#39;</span> <span class="p">)</span>

<span class="n">alpha_32L</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.000471227</span><span class="p">,</span><span class="mf">0.0101724</span><span class="p">,</span><span class="mf">0.0231813</span><span class="p">,</span><span class="mf">0.0385555</span><span class="p">,</span><span class="mf">0.0557036</span><span class="p">,</span><span class="mf">0.0698951</span><span class="p">,</span><span class="mf">0.0829041</span><span class="p">,</span><span class="mf">0.0994609</span><span class="p">,</span><span class="mf">0.116609</span><span class="p">,</span><span class="mf">0.154453</span><span class="p">,</span><span class="mf">0.199984</span><span class="p">,</span><span class="mf">0.260298</span><span class="p">,</span><span class="mf">0.331256</span><span class="p">,</span><span class="mf">0.383883</span><span class="p">,</span><span class="mf">0.433553</span><span class="p">]</span>
<span class="n">rms_32L</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.548029</span><span class="p">,</span><span class="mf">0.48583</span><span class="p">,</span><span class="mf">0.434262</span><span class="p">,</span><span class="mf">0.395134</span><span class="p">,</span><span class="mf">0.370707</span><span class="p">,</span><span class="mf">0.362564</span><span class="p">,</span><span class="mf">0.360981</span><span class="p">,</span><span class="mf">0.363695</span><span class="p">,</span><span class="mf">0.371385</span><span class="p">,</span><span class="mf">0.394003</span><span class="p">,</span><span class="mf">0.424989</span><span class="p">,</span><span class="mf">0.463665</span><span class="p">,</span><span class="mf">0.504151</span><span class="p">,</span><span class="mf">0.528804</span><span class="p">,</span><span class="mf">0.550064</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alpha_32L</span><span class="p">,</span> <span class="n">rms_32L</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">:&#39;</span><span class="o">%</span><span class="n">colorD</span><span class="p">[</span><span class="mi">32</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Nsteps=32, Sutton&#39;</span> <span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">)</span> <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Figure 7.2 Gamma = </span><span class="si">%g</span><span class="s1">, Ave Over </span><span class="si">%i</span><span class="s1"> Runs</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">GAMMA</span><span class="p">,</span> <span class="n">AVE_OVER</span><span class="p">)</span> <span class="o">+</span>\
             <span class="n">rw_mrp</span><span class="o">.</span><span class="n">info</span> <span class="o">+</span> <span class="s1">&#39; with Equiprobable Policy&#39;</span> <span class="p">)</span>
<span class="c1">#ax.axhline(y=0, color=&#39;k&#39;)</span>
<span class="c1">#ax.axvline(x=0, color=&#39;k&#39;)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;figure_7_2_random_walk_19.png&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</td></tr></table></body></html>