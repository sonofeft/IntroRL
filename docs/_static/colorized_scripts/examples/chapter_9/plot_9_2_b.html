<html><head><title>plot_9_2_b.py</title></head><body>
<style type="text/css">.default .hll { background-color: #ffffcc }
.default  { background: #f8f8f8; font-family: Courier New, monospace; font-size: 16px; }
.linenos { width: 40px;  font-family: Courier New, monospace; font-size: 16px; }
.default .c { color: #408080; font-style: italic } /* Comment */
.default .err { border: 1px solid #FF0000 } /* Error */
.default .k { color: #008000; font-weight: bold } /* Keyword */
.default .o { color: #666666 } /* Operator */
.default .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.default .cp { color: #BC7A00 } /* Comment.Preproc */
.default .c1 { color: #408080; font-style: italic } /* Comment.Single */
.default .cs { color: #408080; font-style: italic } /* Comment.Special */
.default .gd { color: #A00000 } /* Generic.Deleted */
.default .ge { font-style: italic } /* Generic.Emph */
.default .gr { color: #FF0000 } /* Generic.Error */
.default .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.default .gi { color: #00A000 } /* Generic.Inserted */
.default .go { color: #808080 } /* Generic.Output */
.default .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.default .gs { font-weight: bold } /* Generic.Strong */
.default .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.default .gt { color: #0040D0 } /* Generic.Traceback */
.default .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.default .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.default .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.default .kp { color: #008000 } /* Keyword.Pseudo */
.default .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.default .kt { color: #B00040 } /* Keyword.Type */
.default .m { color: #666666 } /* Literal.Number */
.default .s { color: #BA2121 } /* Literal.String */
.default .na { color: #7D9029 } /* Name.Attribute */
.default .nb { color: #008000 } /* Name.Builtin */
.default .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.default .no { color: #880000 } /* Name.Constant */
.default .nd { color: #AA22FF } /* Name.Decorator */
.default .ni { color: #999999; font-weight: bold } /* Name.Entity */
.default .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.default .nf { color: #0000FF } /* Name.Function */
.default .nl { color: #A0A000 } /* Name.Label */
.default .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.default .nt { color: #008000; font-weight: bold } /* Name.Tag */
.default .nv { color: #19177C } /* Name.Variable */
.default .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.default .w { color: #bbbbbb } /* Text.Whitespace */
.default .mf { color: #666666 } /* Literal.Number.Float */
.default .mh { color: #666666 } /* Literal.Number.Hex */
.default .mi { color: #666666 } /* Literal.Number.Integer */
.default .mo { color: #666666 } /* Literal.Number.Oct */
.default .sb { color: #BA2121 } /* Literal.String.Backtick */
.default .sc { color: #BA2121 } /* Literal.String.Char */
.default .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.default .s2 { color: #BA2121 } /* Literal.String.Double */
.default .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.default .sh { color: #BA2121 } /* Literal.String.Heredoc */
.default .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.default .sx { color: #008000 } /* Literal.String.Other */
.default .sr { color: #BB6688 } /* Literal.String.Regex */
.default .s1 { color: #BA2121 } /* Literal.String.Single */
.default .ss { color: #19177C } /* Literal.String.Symbol */
.default .bp { color: #008000 } /* Name.Builtin.Pseudo */
.default .vc { color: #19177C } /* Name.Variable.Class */
.default .vg { color: #19177C } /* Name.Variable.Global */
.default .vi { color: #19177C } /* Name.Variable.Instance */
.default .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<h2>plot_9_2_b.py</h2>
<table class="defaulttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134</pre></div></td><td class="code"><div class="default"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">array</span>
<span class="kn">from</span> <span class="nn">introrl.agent_supt.learning_tracker</span> <span class="kn">import</span> <span class="n">LearnTracker</span>
<span class="kn">from</span> <span class="nn">introrl.policy</span> <span class="kn">import</span> <span class="n">Policy</span>
<span class="kn">from</span> <span class="nn">introrl.agent_supt.epsilon_calc</span> <span class="kn">import</span> <span class="n">EpsilonGreedy</span>
<span class="kn">from</span> <span class="nn">introrl.agent_supt.alpha_calc</span> <span class="kn">import</span> <span class="n">Alpha</span>
<span class="kn">from</span> <span class="nn">introrl.agent_supt.episode_maker</span> <span class="kn">import</span> <span class="n">make_episode</span>
<span class="kn">from</span> <span class="nn">introrl.agent_supt.nstep_td_eval_walker</span> <span class="kn">import</span> <span class="n">NStepTDWalker</span>
<span class="kn">from</span> <span class="nn">introrl.black_box_sims.random_walk_1000</span> <span class="kn">import</span> <span class="n">RandomWalk_1000Simulation</span>
<span class="kn">from</span> <span class="nn">introrl.utils.running_ave</span> <span class="kn">import</span> <span class="n">RunningAve</span>

<span class="kn">from</span> <span class="nn">rw1000_func</span> <span class="kn">import</span> <span class="n">AggregatedRandomWalk1000_Func</span>

<span class="n">GAMMA</span><span class="o">=</span><span class="mf">1.0</span>
<span class="n">AVE_OVER</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">RW</span> <span class="o">=</span> <span class="n">RandomWalk_1000Simulation</span><span class="p">()</span>

<span class="n">policy</span> <span class="o">=</span> <span class="n">Policy</span><span class="p">(</span><span class="n">environment</span><span class="o">=</span><span class="n">RW</span><span class="p">)</span>
<span class="n">policy</span><span class="o">.</span><span class="n">intialize_policy_to_equiprobable</span><span class="p">(</span> <span class="n">env</span><span class="o">=</span><span class="n">RW</span> <span class="p">)</span>

<span class="n">episode</span> <span class="o">=</span> <span class="n">make_episode</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="n">policy</span><span class="p">,</span> <span class="n">RW</span><span class="p">,</span> <span class="n">max_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>

<span class="c1"># ----------------------------------------- generate data -------------</span>
<span class="n">alphaL</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.05</span><span class="o">*</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">21</span><span class="p">)]</span>

<span class="n">nstepL</span> <span class="o">=</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">]</span>

<span class="n">nstep_walkerL</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">ave_rms_aveD</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># index=(alpha, Nsteps), value=RunningAve</span>
<span class="n">sv_funcD</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># index=(alpha, Nsteps), value=AggregatedRandomWalk1000_Func</span>
    

<span class="c1"># create data structures</span>
<span class="k">for</span> <span class="n">Nsteps</span> <span class="ow">in</span> <span class="n">nstepL</span><span class="p">:</span>
    <span class="n">nstep_walkerL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">NStepTDWalker</span><span class="p">(</span><span class="n">RW</span><span class="p">,</span> <span class="n">Nsteps</span><span class="o">=</span><span class="n">Nsteps</span><span class="p">,</span>  <span class="n">episode_obj</span><span class="o">=</span><span class="n">episode</span><span class="p">)</span> <span class="p">)</span>
    <span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">alphaL</span><span class="p">:</span>
        <span class="n">ave_rms_aveD</span><span class="p">[</span> <span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">Nsteps</span><span class="p">)</span> <span class="p">]</span> <span class="o">=</span> <span class="n">RunningAve</span><span class="p">()</span>
        <span class="n">sv_funcD</span><span class="p">[</span> <span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">Nsteps</span><span class="p">)</span> <span class="p">]</span> <span class="o">=</span> <span class="n">AggregatedRandomWalk1000_Func</span><span class="p">(</span> <span class="n">RW</span><span class="p">,</span> <span class="n">num_regions</span><span class="o">=</span><span class="mi">20</span> <span class="p">)</span>

<span class="c1"># begin main loop over runs</span>
<span class="k">for</span> <span class="n">loop</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">AVE_OVER</span><span class="p">):</span> <span class="c1"># average rms curves over AVE_OVER runs</span>
    <span class="k">if</span> <span class="n">loop</span><span class="o">%</span><span class="mi">10</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">loop</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    
    <span class="c1"># set state w_vector variables to 0.0</span>
    <span class="k">for</span> <span class="n">Nsteps</span> <span class="ow">in</span>  <span class="n">nstepL</span> <span class="p">:</span>
        <span class="k">for</span>  <span class="n">alpha</span> <span class="ow">in</span> <span class="n">alphaL</span><span class="p">:</span>
            <span class="n">sv_funcD</span><span class="p">[</span> <span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">Nsteps</span><span class="p">)</span> <span class="p">]</span><span class="o">.</span><span class="n">init_w_vector</span><span class="p">()</span>

    <span class="c1"># look at first 10 episodes</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">episode</span> <span class="o">=</span> <span class="n">make_episode</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="n">policy</span><span class="p">,</span> <span class="n">RW</span><span class="p">,</span> <span class="n">max_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
        
        <span class="c1"># have each alpha and Nsteps use the same episode_obj</span>
        <span class="k">for</span> <span class="n">istep</span><span class="p">,</span><span class="n">Nsteps</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="n">nstepL</span> <span class="p">):</span>
            <span class="n">nstep_walkerL</span><span class="p">[</span> <span class="n">istep</span> <span class="p">]</span><span class="o">.</span><span class="n">set_episode_obj</span><span class="p">(</span> <span class="n">episode</span> <span class="p">)</span>
            
            <span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">alphaL</span><span class="p">:</span>
                <span class="n">nstep_walkerL</span><span class="p">[</span> <span class="n">istep</span> <span class="p">]</span><span class="o">.</span><span class="n">do_td_sv_function_updates</span><span class="p">(</span> <span class="n">sv_funcD</span><span class="p">[</span> <span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">Nsteps</span><span class="p">)</span> <span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="n">GAMMA</span><span class="p">)</span>

                <span class="c1"># get the RMS after each episode.</span>
                <span class="n">rms</span> <span class="o">=</span> <span class="n">sv_funcD</span><span class="p">[</span> <span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">Nsteps</span><span class="p">)</span> <span class="p">]</span><span class="o">.</span><span class="n">calc_rms_error</span><span class="p">()</span>
                <span class="n">ave_rms_aveD</span><span class="p">[</span> <span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">Nsteps</span><span class="p">)</span> <span class="p">]</span><span class="o">.</span><span class="n">add_val</span><span class="p">(</span> <span class="n">rms</span> <span class="p">)</span>
        
<span class="k">print</span><span class="p">()</span>

<span class="n">colorD</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">:</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">:</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="mi">64</span><span class="p">:</span><span class="s1">&#39;y&#39;</span><span class="p">}</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="p">)</span>

<span class="k">for</span> <span class="n">Nsteps</span> <span class="ow">in</span>  <span class="n">nstepL</span> <span class="p">:</span>
    <span class="n">ave_rmsL</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span>  <span class="n">alpha</span> <span class="ow">in</span> <span class="n">alphaL</span><span class="p">:</span>
        <span class="n">ave_rmsL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">ave_rms_aveD</span><span class="p">[</span> <span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">Nsteps</span><span class="p">)</span> <span class="p">]</span><span class="o">.</span><span class="n">get_ave</span><span class="p">()</span> <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alphaL</span><span class="p">,</span> <span class="n">ave_rmsL</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">-&#39;</span><span class="o">%</span><span class="n">colorD</span><span class="p">[</span><span class="n">Nsteps</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Nsteps=</span><span class="si">%i</span><span class="s1">, IntroRL&#39;</span><span class="o">%</span><span class="n">Nsteps</span> <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">])</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Ave. RMS Error (</span><span class="si">%i</span><span class="s1"> experiments)&#39;</span><span class="o">%</span><span class="n">AVE_OVER</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Alpha &#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;($\alpha$)&#39;</span><span class="p">)</span>

<span class="c1"># Zhang Results</span>
<span class="n">alphas</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mf">0.</span>  <span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span> <span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.2</span> <span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.3</span> <span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.4</span> <span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.5</span> <span class="p">,</span>
       <span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.6</span> <span class="p">,</span> <span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.7</span> <span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.8</span> <span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="mf">0.9</span> <span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mf">1.</span>  <span class="p">])</span>
<span class="n">errors_1</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mf">0.54346485</span><span class="p">,</span> <span class="mf">0.52301194</span><span class="p">,</span> <span class="mf">0.50422126</span><span class="p">,</span> <span class="mf">0.48708255</span><span class="p">,</span> <span class="mf">0.47056158</span><span class="p">,</span>
       <span class="mf">0.45567889</span><span class="p">,</span> <span class="mf">0.44140045</span><span class="p">,</span> <span class="mf">0.42716099</span><span class="p">,</span> <span class="mf">0.41436938</span><span class="p">,</span> <span class="mf">0.40267275</span><span class="p">,</span>
       <span class="mf">0.39003853</span><span class="p">,</span> <span class="mf">0.38330027</span><span class="p">,</span> <span class="mf">0.37146481</span><span class="p">,</span> <span class="mf">0.36243917</span><span class="p">,</span> <span class="mf">0.35870504</span><span class="p">,</span>
       <span class="mf">0.35365013</span><span class="p">,</span> <span class="mf">0.35120526</span><span class="p">,</span> <span class="mf">0.35458384</span><span class="p">,</span> <span class="mf">0.3644122</span> <span class="p">,</span> <span class="mf">0.38543964</span><span class="p">,</span>
       <span class="mf">0.42865446</span><span class="p">])</span>
<span class="n">errors_2</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mf">0.54346485</span><span class="p">,</span> <span class="mf">0.50518009</span><span class="p">,</span> <span class="mf">0.47220401</span><span class="p">,</span> <span class="mf">0.44207045</span><span class="p">,</span> <span class="mf">0.41447032</span><span class="p">,</span>
       <span class="mf">0.39015081</span><span class="p">,</span> <span class="mf">0.37025748</span><span class="p">,</span> <span class="mf">0.35328462</span><span class="p">,</span> <span class="mf">0.33449132</span><span class="p">,</span> <span class="mf">0.32323272</span><span class="p">,</span>
       <span class="mf">0.30557266</span><span class="p">,</span> <span class="mf">0.31316945</span><span class="p">,</span> <span class="mf">0.30634503</span><span class="p">,</span> <span class="mf">0.30789654</span><span class="p">,</span> <span class="mf">0.31302827</span><span class="p">,</span>
       <span class="mf">0.31636149</span><span class="p">,</span> <span class="mf">0.32863725</span><span class="p">,</span> <span class="mf">0.34385915</span><span class="p">,</span> <span class="mf">0.36679105</span><span class="p">,</span> <span class="mf">0.39808092</span><span class="p">,</span>
       <span class="mf">0.46138648</span><span class="p">])</span>
<span class="n">errors_4</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mf">0.54346485</span><span class="p">,</span> <span class="mf">0.47593027</span><span class="p">,</span> <span class="mf">0.42042463</span><span class="p">,</span> <span class="mf">0.37794216</span><span class="p">,</span> <span class="mf">0.33931033</span><span class="p">,</span>
       <span class="mf">0.31800676</span><span class="p">,</span> <span class="mf">0.29180674</span><span class="p">,</span> <span class="mf">0.28936826</span><span class="p">,</span> <span class="mf">0.28595051</span><span class="p">,</span> <span class="mf">0.29069073</span><span class="p">,</span>
       <span class="mf">0.28938636</span><span class="p">,</span> <span class="mf">0.30235311</span><span class="p">,</span> <span class="mf">0.32006741</span><span class="p">,</span> <span class="mf">0.3328899</span> <span class="p">,</span> <span class="mf">0.34431006</span><span class="p">,</span>
       <span class="mf">0.36134708</span><span class="p">,</span> <span class="mf">0.38558591</span><span class="p">,</span> <span class="mf">0.4047511</span> <span class="p">,</span> <span class="mf">0.43499991</span><span class="p">,</span> <span class="mf">0.47766768</span><span class="p">,</span>
       <span class="mf">0.51614276</span><span class="p">])</span>
<span class="n">errors_8</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mf">0.54346485</span><span class="p">,</span> <span class="mf">0.4341758</span> <span class="p">,</span> <span class="mf">0.36464929</span><span class="p">,</span> <span class="mf">0.32592566</span><span class="p">,</span> <span class="mf">0.29949156</span><span class="p">,</span>
       <span class="mf">0.29720932</span><span class="p">,</span> <span class="mf">0.30412968</span><span class="p">,</span> <span class="mf">0.3203433</span> <span class="p">,</span> <span class="mf">0.33691732</span><span class="p">,</span> <span class="mf">0.34452017</span><span class="p">,</span>
       <span class="mf">0.3620062</span> <span class="p">,</span> <span class="mf">0.37790436</span><span class="p">,</span> <span class="mf">0.39290479</span><span class="p">,</span> <span class="mf">0.41713231</span><span class="p">,</span> <span class="mf">0.43736459</span><span class="p">,</span>
       <span class="mf">0.46064813</span><span class="p">,</span> <span class="mf">0.47416269</span><span class="p">,</span> <span class="mf">0.4973127</span> <span class="p">,</span> <span class="mf">0.52604507</span><span class="p">,</span> <span class="mf">0.55826309</span><span class="p">,</span>
       <span class="mf">0.60975813</span><span class="p">])</span>
<span class="n">errors_16</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mf">0.54346485</span><span class="p">,</span> <span class="mf">0.39700918</span><span class="p">,</span> <span class="mf">0.34108609</span><span class="p">,</span> <span class="mf">0.32901849</span><span class="p">,</span> <span class="mf">0.34715719</span><span class="p">,</span>
       <span class="mf">0.35510326</span><span class="p">,</span> <span class="mf">0.37792898</span><span class="p">,</span> <span class="mf">0.40125412</span><span class="p">,</span> <span class="mf">0.42833899</span><span class="p">,</span> <span class="mf">0.44357229</span><span class="p">,</span>
       <span class="mf">0.46547058</span><span class="p">,</span> <span class="mf">0.4831478</span> <span class="p">,</span> <span class="mf">0.50590963</span><span class="p">,</span> <span class="mf">0.52734658</span><span class="p">,</span> <span class="mf">0.5353047</span> <span class="p">,</span>
       <span class="mf">0.55963969</span><span class="p">,</span> <span class="mf">0.57939287</span><span class="p">,</span> <span class="mf">0.60298622</span><span class="p">,</span> <span class="mf">0.62398708</span><span class="p">,</span> <span class="mf">0.63582318</span><span class="p">,</span>
       <span class="mf">0.67225318</span><span class="p">])</span>
<span class="n">errors_32</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mf">0.54346485</span><span class="p">,</span> <span class="mf">0.39239582</span><span class="p">,</span> <span class="mf">0.37649445</span><span class="p">,</span> <span class="mf">0.40578772</span><span class="p">,</span> <span class="mf">0.43884392</span><span class="p">,</span>
       <span class="mf">0.46203138</span><span class="p">,</span> <span class="mf">0.49513178</span><span class="p">,</span> <span class="mf">0.5169309</span> <span class="p">,</span> <span class="mf">0.54472173</span><span class="p">,</span> <span class="mf">0.56154064</span><span class="p">,</span>
       <span class="mf">0.5883069</span> <span class="p">,</span> <span class="mf">0.59643114</span><span class="p">,</span> <span class="mf">0.62920153</span><span class="p">,</span> <span class="mf">0.63582551</span><span class="p">,</span> <span class="mf">0.64777206</span><span class="p">,</span>
       <span class="mf">0.66612973</span><span class="p">,</span> <span class="mf">0.67598703</span><span class="p">,</span> <span class="mf">0.68303723</span><span class="p">,</span> <span class="mf">0.7102483</span> <span class="p">,</span> <span class="mf">0.71351987</span><span class="p">,</span>
       <span class="mf">0.73641854</span><span class="p">])</span>
<span class="n">errors_64</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mf">0.54346485</span><span class="p">,</span> <span class="mf">0.43187701</span><span class="p">,</span> <span class="mf">0.46706372</span><span class="p">,</span> <span class="mf">0.49905741</span><span class="p">,</span> <span class="mf">0.55088214</span><span class="p">,</span>
       <span class="mf">0.55765315</span><span class="p">,</span> <span class="mf">0.60665472</span><span class="p">,</span> <span class="mf">0.63412362</span><span class="p">,</span> <span class="mf">0.63723193</span><span class="p">,</span> <span class="mf">0.67687787</span><span class="p">,</span>
       <span class="mf">0.66504584</span><span class="p">,</span> <span class="mf">0.68964987</span><span class="p">,</span> <span class="mf">0.70802699</span><span class="p">,</span> <span class="mf">0.73256161</span><span class="p">,</span> <span class="mf">0.72771667</span><span class="p">,</span>
       <span class="mf">0.74394468</span><span class="p">,</span> <span class="mf">0.74957095</span><span class="p">,</span> <span class="mf">0.75065964</span><span class="p">,</span> <span class="mf">0.76162076</span><span class="p">,</span> <span class="mf">0.76997655</span><span class="p">,</span>
       <span class="mf">0.7911325</span> <span class="p">])</span>
<span class="n">zhang_rmsD</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="n">errors_1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="n">errors_2</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span><span class="n">errors_4</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span><span class="n">errors_8</span><span class="p">,</span> <span class="mi">16</span><span class="p">:</span><span class="n">errors_16</span><span class="p">,</span> <span class="mi">32</span><span class="p">:</span><span class="n">errors_32</span><span class="p">,</span> <span class="mi">64</span><span class="p">:</span><span class="n">errors_64</span><span class="p">}</span>

<span class="k">for</span> <span class="n">Nsteps</span> <span class="ow">in</span>  <span class="n">nstepL</span> <span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alphas</span><span class="p">,</span> <span class="n">zhang_rmsD</span><span class="p">[</span><span class="n">Nsteps</span><span class="p">],</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">:&#39;</span><span class="o">%</span><span class="n">colorD</span><span class="p">[</span><span class="n">Nsteps</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Nsteps=</span><span class="si">%i</span><span class="s1">, Zhang&#39;</span><span class="o">%</span><span class="n">Nsteps</span> <span class="p">)</span>


<span class="c1">#ax.legend( fontsize=8, loc=&#39;upper left&#39;, bbox_to_anchor=(0.15, 0.99), framealpha=0.25 )</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">0.25</span> <span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Figure 9.2 Gamma = </span><span class="si">%g</span><span class="s1">, Ave Over </span><span class="si">%i</span><span class="s1"> Runs</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">GAMMA</span><span class="p">,</span> <span class="n">AVE_OVER</span><span class="p">)</span> <span class="o">+</span>\
             <span class="s1">&#39;Aggregated Random Walk 1000 with Equiprobable Policy&#39;</span> <span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;figure_9_2_random_walk_nstep.png&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</td></tr></table></body></html>